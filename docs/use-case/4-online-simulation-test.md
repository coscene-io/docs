---
sidebar_position: 4
---

# äº‘ç«¯ä»¿çœŸè‡ªåŠ¨åŒ–ç®—æ³•éªŒè¯

## èƒŒæ™¯

åœ¨æ³›æœºå™¨äººç ”å‘è¿‡ç¨‹ä¸­ï¼Œé’ˆå¯¹ç®—æ³•å’Œè½¯ä»¶çš„åå¤æµ‹è¯•ä¸éªŒè¯ï¼Œæ˜¯æ—¥å¸¸å·¥ä½œä¸­æœ€è€—æ—¶ã€æœ€å®¹æ˜“å‡ºé”™çš„ä¸€ç¯ã€‚

ä½ æ˜¯ä¸æ˜¯ä¹Ÿç»å†è¿‡è¿™æ ·çš„æ—¥å¸¸ï¼Ÿ

- ç®—æ³•æ”¹äº†ä¸€è¡Œä»£ç ï¼Œç»“æœæµ‹äº†ä¸€æ•´å¤©  
- æœ¬åœ°ä»¿çœŸç¯å¢ƒçªç„¶åæ‰ï¼Œé‡è£…åˆè¸©å‘  
- å¤šäººåä½œï¼Œå„æµ‹å„çš„ï¼Œç»“æœå¯¹ä¸ä¸Šâ€¦

å°¤å…¶å¯¹äº**ç§»åŠ¨æœºå™¨äººã€å…·èº«æ™ºèƒ½**ç­‰é¢†åŸŸçš„ç ”å‘äººå‘˜æ¥è¯´ï¼š

- è½¯ä»¶æ›´æ–°é¢‘ç¹  
- ä»¿çœŸç¯å¢ƒæ­å»ºå¤æ‚  
- æµ‹è¯•æ ‡å‡†ä¸ç»Ÿä¸€  
- æœ¬åœ°æµ‹è¯•æ’é˜Ÿä¸¥é‡  

è¿™äº›é—®é¢˜å¯¼è‡´æœ¬åœ°æµ‹è¯•æ•ˆç‡ä½ä¸‹ã€åä½œå›°éš¾ã€‚

---

åˆ»è¡Œæ—¶ç©ºä¸€ç›´åœ¨æ€è€ƒï¼šæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•ï¼Œåªè¦ä¿®æ”¹å®Œç®—æ³•ï¼Œå°±å¯ä»¥éšæ—¶è¿›è¡Œæ— ç—›è¿›è¡Œæ•ˆæœéªŒè¯ï¼Œè¿˜èƒ½æŠŠæµ‹è¯•ç»“æœæ ‡å‡†è¾“å‡ºï¼Ÿ

åˆ»è¡Œæ—¶ç©ºåœ¨**æ•°æ®é—­ç¯**ä¸**ç”Ÿäº§åŠ›å·¥å…·**æ­å»ºæ–¹é¢æ‹¥æœ‰ä¸°å¯Œç»éªŒï¼ŒåŸºäºæˆ‘ä»¬å…ˆè¿›çš„ **ScenenOps ç†å¿µ**ï¼Œæä¾›äº†ä¸€ç«™å¼äº‘ç«¯ä»¿çœŸå¹³å°ï¼š  
**ç®€å•äº”æ­¥ï¼Œå®Œæˆå¹³å°æ­å»ºï¼Œä½ åªéœ€ä¸Šä¼ ç¨‹åºï¼Œå¹³å°è‡ªåŠ¨è¿è¡Œæµ‹è¯•ã€ç”Ÿæˆå¯è§†åŒ–ç»“æœï¼Œå…¨æµç¨‹åœ¨çº¿ã€é›¶ä¾èµ–ï¼**
![4-online-simulation-test-1](./img/4-online-simulation-test-1.png)

æœ¬æ–‡ä»¥ Ubuntu22.04 + ros2-humble + gazebo ç¯å¢ƒä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•åœ¨ä¿®æ”¹å®Œç®—æ³•ç¨‹åºåé€šè¿‡åˆ»è¡Œæ—¶ç©ºå¹³å°è¿›è¡Œç›´æ¥ä»¿çœŸæµ‹è¯•ã€‚

æ›´å¤šä»¿çœŸè½¯ä»¶çš„æ”¯æŒï¼Œè¯·å…³æ³¨åˆ»è¡Œæ—¶ç©ºå®˜ç½‘ï¼š[åˆ»è¡Œæ—¶ç©ºå¹³å°](https://www.coscene.cn/)ã€‚

---

## ğŸ§± Step 1ï¼šæ„å»ºå±äºä½ è‡ªå·±çš„ç®—æ³•ä¸è½¯ä»¶æµ‹è¯•åº•åº§

æˆ‘ä»¬çŸ¥é“ï¼Œæ¯æ”¯å›¢é˜Ÿçš„æŠ€æœ¯æ ˆéƒ½ä¸ä¸€æ ·ã€‚  
å› æ­¤ï¼Œæˆ‘ä»¬æ”¯æŒç”¨æˆ·åŸºäºè‡ªå·±çš„ç³»ç»Ÿä¾èµ–æ„å»ºä¸“å±é•œåƒå¹¶ä¸Šä¼ ã€‚

ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ Dockerfile æ¨¡æ¿æ¥æ„å»ºç¯å¢ƒï¼š

```Dockerfile
# syntax = docker/dockerfile:1.2
ARG BASE_IMAGE=osrf/ros:humble-desktop-full
FROM ${BASE_IMAGE} as base
...
WORKDIR /action/ros2_ws
```

å¼€æºç¤ºä¾‹é¡¹ç›® ğŸ‘‰ [Regression_Test-Sample](https://github.com/coscene-io/Regression_Test-Sample/blob/main/Dockerfile)

æ„å»ºå®Œæˆåï¼Œæ‰“åŒ…æ¨é€è‡³å¹³å°é•œåƒä»“åº“ï¼Œå…¨å…¬å¸åŒäº‹å¯å¤ç”¨è¿™ä¸ªç¨³å®šçš„æµ‹è¯•ç¯å¢ƒï¼Œæ— éœ€æœ¬åœ°é‡å¤æ­å»ºã€‚

1. ç™»å½•åˆ»è¡Œæ—¶ç©ºå¹³å°ï¼Œè¿›å…¥ç»„ç»‡ç®¡ç†è·å–ä¸“å±é•œåƒä»“åº“åœ°å€
![4-online-simulation-test-2](./img/4-online-simulation-test-2.PNG)
![4-online-simulation-test-3](./img/4-online-simulation-test-3.PNG)
![4-online-simulation-test-4](./img/4-online-simulation-test-4.PNG)

2. ç™»å½• Docker å¹¶æ‰“åŒ…æ¨é€é•œåƒ  
![4-online-simulation-test-5](./img/4-online-simulation-test-5.PNG)

3. ç™»å½•å¹³å°æŸ¥çœ‹é•œåƒå¹¶è·å–é“¾æ¥  
![4-online-simulation-test-6](./img/4-online-simulation-test-6.png)

å®Œæˆä¸Šè¿°æ“ä½œåï¼Œç›¸å½“äºä¸ºåç»­çš„å„ç§ä»¿çœŸç®—æ³•æµ‹è¯•éªŒè¯ï¼Œæ­å»ºäº†ä¸€å¥—å®Œæ•´çš„è¿è¡Œç¯å¢ƒåº•åº§ï¼Œé‡Œé¢åŒ…å«äº†æ‰€æœ‰éœ€è¦çš„æµ‹è¯•è½¯ä»¶ä¾èµ–ç¯å¢ƒã€‚

---

## ğŸ“¦ Step 2ï¼šä¸Šä¼ ä½ çš„ç®—æ³•ä¸æµ‹è¯•ç¨‹åº

ç®—æ³•/è½¯ä»¶ä»£ç ä¿®æ”¹å®Œæˆåï¼Œå¯¹ä»£ç è¿›è¡Œç¼–è¯‘ã€‚
![4-online-simulation-test-7](./img/4-online-simulation-test-7.png)

å°†å…¶å‹ç¼©ä¸º `.zip` æˆ– `.tar.gz` ä¸Šä¼ è‡³å¹³å°ï¼Œå»ºè®®ä¸Šä¼  `install` ç›®å½•çš„å‹ç¼©åŒ…ï¼š

```bash
tar -czvf install.tar.gz ./install
```
è¿›å…¥å¹³å°é¡¹ç›®ï¼Œç‚¹å‡»ä¸Šä¼ ç¨‹åºæŒ‰é’®ï¼Œå¹³å°å°†è‡ªåŠ¨è§£å‹å¹¶åœ¨åç»­æ‰§è¡Œæµ‹è¯•æ—¶ï¼Œåœ¨å¯¹åº”å®¹å™¨ä¸­è¿è¡Œã€‚
![4-online-simulation-test-8](./img/4-online-simulation-test-8.png)

![4-online-simulation-test-9](./img/4-online-simulation-test-9.png)

![4-online-simulation-test-10](./img/4-online-simulation-test-10.png)

![4-online-simulation-test-11](./img/4-online-simulation-test-11.png)

åŒæ—¶æ”¯æŒï¼š

- æºç æ„å»ºä¸ç¼–è¯‘åçš„å¯æ‰§è¡Œç¨‹åº

å¯å‚è€ƒå¹³å°æ–‡æ¡£ ğŸ‘‰ https://docs.coscene.cn/docs/sim-and-tests/regression/test-bundle-management

***å¯¹äºä¼ä¸šç”¨æˆ·ï¼Œè¿˜æ”¯æŒ GitHub / GitLab æŒç»­é›†æˆä¸Šä¼ æ„å»ºäº§ç‰©ï¼Œè·³è¿‡æ‰‹åŠ¨ä¸Šä¼ è¿‡ç¨‹ã€‚***

---

## ğŸ§ª Step 3ï¼šå‡†å¤‡ä½ çš„æµ‹è¯•ç”¨ä¾‹

å¹³å°æ”¯æŒé€šè¿‡ `ç»„ç»‡ â†’ é¡¹ç›® â†’ è®°å½•` çš„ç»“æ„ï¼Œé…ç½®å¤šæ¡æµ‹è¯•ç”¨ä¾‹ã€‚

æ¯æ¡æµ‹è¯•è®°å½•å°±åƒä¸€ä¸ªé¢„è®¾çš„è™šæ‹Ÿæµ‹è¯•ç°åœºï¼š

- åœ°å›¾ï¼š`map.pgm` + `map.yaml`
- æœºå™¨äººæ¨¡å‹ï¼šå¦‚ `turtlebot3_waffle_pi`
- é…ç½®æ–‡ä»¶ï¼šå¦‚ `case.yaml`
- Gazebo world æ–‡ä»¶ï¼šå®šä¹‰ä»¿çœŸç¯å¢ƒ
- å…¶ä»–æµ‹è¯•ä¾èµ–èµ„æº

æµ‹è¯•è®°å½•æ–‡ä»¶ç»“æ„ç¤ºä¾‹ï¼š

```
test_case/
â”œâ”€â”€ map.pgm
â”œâ”€â”€ map.yaml
â”œâ”€â”€ case.yaml
â”œâ”€â”€ world.world
â”œâ”€â”€ extra_configs/
```

![4-online-simulation-test-12](./img/4-online-simulation-test-12.png)

> â„¹ï¸ **æ³¨æ„ï¼š**
> 
> 1. ä¸Šä¼ æ–‡ä»¶æ—¶è¯·éµå¾ªå¹³å°è§„å®šè·¯å¾„ç»“æ„ï¼Œæ–‡æ¡£å‚è€ƒï¼šhttps://docs.coscene.cn/docs/sim-and-tests/regression/intro
![4-online-simulation-test-13](./img/4-online-simulation-test-13.png)  
> 2. éœ€è¦æå‰ä¸ºè®°å½•æ·»åŠ æ ‡ç­¾ï¼ˆå¦‚ `Navigation_Error`ï¼‰ï¼Œç”¨äºåç»­è‡ªåŠ¨åŒ–æµ‹è¯•ç­›é€‰è§¦å‘ï¼Œå‚è€ƒä¸‹è¿°æµç¨‹ï¼š
![4-online-simulation-test-14](./img/4-online-simulation-test-14.png)
![4-online-simulation-test-15](./img/4-online-simulation-test-15.png)
![4-online-simulation-test-16](./img/4-online-simulation-test-16.png)
![4-online-simulation-test-17](./img/4-online-simulation-test-17.png)
å®Œæˆä¸Šè¿°æµç¨‹åï¼Œåœ¨ä¸‹ä¸€æ­¥çš„é…ç½®é¡µé¢ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¾ç½®åªæœ‰å¸¦æœ‰ 'Navigation_Error' æ ‡ç­¾çš„è®°å½•æ‰ä¼šä½œä¸ºè‡ªåŠ¨åŒ–æµ‹è¯•çš„è¾“å…¥ç”¨ä¾‹ã€‚
---

## âš™ï¸ Step 4ï¼šé…ç½®æµ‹è¯•è§¦å‘é€»è¾‘

æ¯ä¸ªé¡¹ç›®éƒ½å¯ä»¥é…ç½®è‡ªåŠ¨åŒ–è§¦å‘ç­–ç•¥ï¼š

- æ¯æ¬¡ä¸Šä¼ ç®—æ³•è‡ªåŠ¨è§¦å‘æµ‹è¯•  
- æ‰‹åŠ¨é€‰æ‹©è®°å½•æ‰§è¡Œ  
- æŒ‰æ ‡ç­¾æˆ–ç‰ˆæœ¬ç­›é€‰æµ‹è¯•é›†    

è¯¦ç»†é…ç½®å‚è€ƒ ğŸ‘‰ https://docs.coscene.cn/docs/sim-and-tests/regression/config-management
![4-online-simulation-test-18](./img/4-online-simulation-test-18.png)
![4-online-simulation-test-19](./img/4-online-simulation-test-19.png)
![4-online-simulation-test-20](./img/4-online-simulation-test-20.png)

---

## ğŸ“Š Step 5ï¼šè¿è¡Œæµ‹è¯•ï¼Œè§‚æµ‹æµ‹è¯•è¿‡ç¨‹ä¸ç»“æœ

æµ‹è¯•è¿è¡Œè¿‡ç¨‹ä¸­æ”¯æŒï¼š

- å®æ—¶æŸ¥çœ‹å¯è§†åŒ–é¡µé¢ä¸­æœºå™¨äººè¿è¡ŒçŠ¶æ€ï¼Œæ”¯æŒå¯¼å…¥ gazeboç¯å¢ƒåŒæ­¥æŸ¥çœ‹ã€‚  
- è‡ªåŠ¨å½•åˆ¶æµ‹è¯•è¿‡ç¨‹æ•°æ®ã€‚  
- è¾“å‡ºæ ‡å‡†åŒ–æµ‹è¯•æŠ¥å‘Šã€‚

![4-online-simulation-test-21](./img/4-online-simulation-test-21.png)
![4-online-simulation-test-22](./img/4-online-simulation-test-22.png)
![4-online-simulation-test-23](./img/4-online-simulation-test-23.gif)

æŠ¥å‘Šå†…å®¹ï¼š

   - ğŸ“ æœºå™¨äººè¿è¡Œè½¨è¿¹
   - âœ… æˆåŠŸ / å¤±è´¥è¯„åˆ†æŒ‡æ ‡
   - ğŸªµ æ—¥å¿—è¾“å‡º / å¼‚å¸¸ä¿¡æ¯
   - ğŸ–¼ï¸ å¯è§†åŒ–å›¾è¡¨ä¸ç»Ÿè®¡
![4-online-simulation-test-24](./img/4-online-simulation-test-24.png)
![4-online-simulation-test-25](./img/4-online-simulation-test-25.png)

---

## ğŸš€ ç»“è¯­ï¼šæŠŠç¹ççš„æµ‹è¯•äº¤ç»™åˆ»è¡Œæ—¶ç©ºï¼Œè½»è£…ä¸Šé˜µæç ”å‘

æ¯æ¬¡ä»£ç æ›´æ–°ä¹‹åï¼Œä½ ä¸å†éœ€è¦ï¼š

- åå¤æ­ç¯å¢ƒ
- é‡å¤è¿è¡Œè„šæœ¬
- å¯¹æ¯”æ—¥å¿—æ‰¾ç»“æœ

åªéœ€ä¸€é”®ä¸Šä¼ ï¼Œå¹³å°è‡ªåŠ¨å®ŒæˆéªŒè¯ï¼Œå…¨æµç¨‹æ ‡å‡†åŒ–ã€è‡ªåŠ¨åŒ–ï¼Œå¸®åŠ©ä½ æŠŠæ›´å¤šæ—¶é—´æŠ•å…¥åˆ°çœŸæ­£é‡è¦çš„å·¥ä½œä¸­ï¼

ğŸ‘‰ æ¬¢è¿æ³¨å†Œä½“éªŒï¼šhttps://www.coscene.cn/