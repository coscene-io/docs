---
sidebar_position: 8
---

# 换机、升级、卸载流程指南

## 概述

本篇换机流程适用于当设备需要更换上位机、修改设备 ID、升级客户端或卸载客户端时，为运维人员、技术支持人员及研发人员提供详细的操作步骤及问题解决方法，确保设备在平台上的稳定运行与有效管理。

## 换机流程

### 适用情况

当设备进行上位机更替或设备 ID 修改时，需遵循换机流程，重新执行命令安装注册设备。

### 操作步骤

1. 在「组织设备」页面，点击【添加设备】按钮

   ![添加设备入口](./img/4-3-add-device-button.png)

2. 获取安装命令

   - 确保即将安装的设备的设备 ID 相关信息无误
   - 勾选需要安装的客户端选项
   - 安装场景：选择「换机重装」，此勾选将清除旧配置文件

  ![勾选初始化](./img/4-3-add-device-initialize-true.png)

3. 设备终端执行命令

   打开设备终端，将复制的命令粘贴并执行，执行过程需保证设备网络连接正常且终端环境符合要求

   ![执行安装命令](./img/4-3-install-successfully.png)

4. 启用设备，安装完成后，联系组织管理员在平台设备管理页面，对设备进行启用，使设备恢复正常使用。

   ![启用设备](./img/4-3-access-device.png)

## 原机版本升级流程

### 适用情况

当设备仅需进行软件版本升级，而不涉及上位机或设备 ID 变更时，采用原机版本升级流程。

### 操作步骤

1. 在「组织设备」页面，点击【添加设备】按钮

   ![添加设备入口](./img/4-3-add-device-button.png)

2. 获取安装命令

   - 确保即将安装的设备的设备 ID 相关信息无误
   - 勾选需要安装的客户端选项
   - 安装场景：选择「首次安装/升级客户端」，此勾选将保留旧配置文件，仅升级客户端软件版本时无需重新启用设备

![取消初始化](./img/4-3-add-device-initialize-false.png)

3. 设备终端执行命令

4. 打开设备终端，将复制的命令粘贴并执行，执行过程需保证设备网络连接正常且终端环境符合要求

![执行安装命令](./img/4-3-install-successfully.png)

## 设备端卸载客户端流程

1. 在设备终端执行以下命令

> 注意：若数采客户端安装在 root 用户下，卸载时需切换为 root 用户。

   ```bash
   /bin/bash -c "$(curl -fsSL https://download.coscene.cn/cosbinary/script/latest/uninstall.sh)"
   ```

2. 执行过程中需密切观察输出，直至卸载流程完成，确保 coLink 服务、cos 服务及其相关配置文件和目录等均被成功移除

   ![卸载客户端](./img/4-3-unload-1.png)

3. 若不再需要该设备，可在组织中删除设备

   ![删除设备](./img/4-3-device-delete.png)

## 常见问题解答

1. **在项目中采集数据，但是设备没有上传数据**

   答：请检查以下信息：

   - 检查设备**是否联网**，确保网络稳定以支持数据上传。
   - 检查设备端**对应时间段是否有数据产生**，确认设备数据生成功能正常。
   - 检查是否有两台设备使用**相同的设备 ID**，如有则需更换其中一台设备的 ID 后重新安装，避免数据冲突。
   - 检查是否将更换下来的**上位机直接用于另一台机器**，若存在此情况，需在该上位机上执行卸载命令或重新安装，确保设备环境独立正确。
