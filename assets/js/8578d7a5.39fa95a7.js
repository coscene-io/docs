"use strict";(self.webpackChunk_coscene_io_docs=self.webpackChunk_coscene_io_docs||[]).push([["6085"],{14379:function(e,i,t){t.r(i),t.d(i,{frontMatter:()=>a,default:()=>h,toc:()=>d,metadata:()=>r,assets:()=>c,contentTitle:()=>o});var r=JSON.parse('{"id":"viz/message-schemas/camera-calibration","title":"CameraCalibration","description":"Panel Support","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/viz/9-message-schemas/camera-calibration.md","sourceDirName":"viz/9-message-schemas","slug":"/viz/message-schemas/camera-calibration","permalink":"/docs/viz/message-schemas/camera-calibration","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"Yujing Zheng","lastUpdatedAt":1750685097000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"CameraCalibration"},"sidebar":"tutorialSidebar","previous":{"title":"ArrowPrimitive","permalink":"/docs/viz/message-schemas/arrow-primitive"},"next":{"title":"CircleAnnotation","permalink":"/docs/viz/message-schemas/circle-annotation"}}'),n=t(96773),s=t(68502);let a={sidebar_position:4,title:"CameraCalibration"},o="CameraCalibration",c={},d=[{value:"Panel Support",id:"panel-support",level:2},{value:"Field Definitions",id:"field-definitions",level:2},{value:"<code>distortion_model</code>",id:"distortion_model",level:3},{value:"<code>K</code> Intrinsic Matrix",id:"k-intrinsic-matrix",level:3},{value:"<code>R</code> Rectification Matrix",id:"r-rectification-matrix",level:3},{value:"<code>P</code> Projection Matrix",id:"p-projection-matrix",level:3},{value:"References",id:"references",level:2}];function l(e){let i={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.header,{children:(0,n.jsx)(i.h1,{id:"cameracalibration",children:"CameraCalibration"})}),"\n",(0,n.jsx)(i.h2,{id:"panel-support",children:"Panel Support"}),"\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.code,{children:"CameraCalibration"})," is used in the ",(0,n.jsx)(i.a,{href:"../panel/2-3d-panel",children:"3D Panel"})," and ",(0,n.jsx)(i.a,{href:"../panel/image-panel",children:"Image Panel"}),"."]}),"\n",(0,n.jsx)(i.h2,{id:"field-definitions",children:"Field Definitions"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Field Name"}),(0,n.jsx)(i.th,{children:"Type"}),(0,n.jsx)(i.th,{children:"Description"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"timestamp"})}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"./built-in%20types#time",children:(0,n.jsx)(i.code,{children:"time"})})}),(0,n.jsx)(i.td,{children:"Timestamp of the calibration data"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"frame_id"})}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"./built-in%20types#string",children:(0,n.jsx)(i.code,{children:"string"})})}),(0,n.jsx)(i.td,{children:"Reference coordinate system of the camera. The origin of this coordinate system is the optical center of the camera, with +x pointing to the right in the image, +y pointing down, and +z pointing into the image plane."})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"width"})}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"./built-in%20types#uint32",children:(0,n.jsx)(i.code,{children:"uint32"})})}),(0,n.jsx)(i.td,{children:"Image width"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"height"})}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"./built-in%20types#uint32",children:(0,n.jsx)(i.code,{children:"uint32"})})}),(0,n.jsx)(i.td,{children:"Image height"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"distortion_model"})}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"./built-in%20types#string",children:(0,n.jsx)(i.code,{children:"string"})})}),(0,n.jsx)(i.td,{children:"Distortion model name"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"D"})}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"./built-in%20types#float64",children:(0,n.jsx)(i.code,{children:"float64[]"})})}),(0,n.jsx)(i.td,{children:"Distortion parameters"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"K"})}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"./built-in%20types#float64",children:(0,n.jsx)(i.code,{children:"float64[9]"})})}),(0,n.jsx)(i.td,{children:"Intrinsic matrix (3x3 row-major storage)"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"R"})}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"./built-in%20types#float64",children:(0,n.jsx)(i.code,{children:"float64[9]"})})}),(0,n.jsx)(i.td,{children:"Rectification matrix (only used for stereo cameras, 3x3 row-major storage)"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"P"})}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"./built-in%20types#float64",children:(0,n.jsx)(i.code,{children:"float64[12]"})})}),(0,n.jsx)(i.td,{children:"Projection/camera matrix (3x4 row-major storage)"})]})]})]}),"\n",(0,n.jsx)(i.h3,{id:"distortion_model",children:(0,n.jsx)(i.code,{children:"distortion_model"})}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.code,{children:"plumb_bob"}),": Parameters are k1, k2, p1, p2, k3"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.code,{children:"rational_polynomial"}),": Parameters are k1, k2, p1, p2, k3, k4, k5, k6"]}),"\n"]}),"\n",(0,n.jsxs)(i.p,{children:["This model is based on ",(0,n.jsx)(i.a,{href:"https://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html",children:"OpenCV's"})," ",(0,n.jsx)(i.a,{href:"https://en.wikipedia.org/wiki/Distortion_%28optics%29#Software_correction",children:"pinhole camera model"})," and is consistent with ",(0,n.jsx)(i.a,{href:"https://docs.ros.org/en/diamondback/api/image_geometry/html/c++/pinhole__camera__model_8cpp_source.html",children:"the implementation in ROS"}),"."]}),"\n",(0,n.jsxs)(i.h3,{id:"k-intrinsic-matrix",children:[(0,n.jsx)(i.code,{children:"K"})," Intrinsic Matrix"]}),"\n",(0,n.jsx)(i.p,{children:"K is a 3x3 row-major matrix for the original (uncorrected) image."}),"\n",(0,n.jsx)(i.p,{children:"It uses the focal lengths (fx, fy) and principal point (cx, cy) to project 3D points in the camera coordinate system to 2D pixel coordinates."}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"    [fx   0  cx]\nK = [ 0  fy  cy]\n    [ 0   0   1]\n"})}),"\n",(0,n.jsxs)(i.h3,{id:"r-rectification-matrix",children:[(0,n.jsx)(i.code,{children:"R"})," Rectification Matrix"]}),"\n",(0,n.jsx)(i.p,{children:"Rotation matrix that aligns the camera coordinate system with the ideal stereo image plane, making epipolar lines in the two stereo images parallel."}),"\n",(0,n.jsxs)(i.h3,{id:"p-projection-matrix",children:[(0,n.jsx)(i.code,{children:"P"})," Projection Matrix"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"    [fx'  0   cx'  Tx]\nP = [ 0   fy' cy'  Ty]\n    [ 0    0    1    0]\n"})}),"\n",(0,n.jsx)(i.p,{children:"This matrix specifies the intrinsic (camera) matrix of the processed (rectified) image. That is, the left 3x3 part is the normal camera intrinsic matrix for the rectified image."}),"\n",(0,n.jsx)(i.p,{children:"It uses the focal lengths (fx', fy') and principal point (cx', cy') to project 3D points in the camera coordinate system to 2D pixel coordinates \u2014 these may differ from the values in K."}),"\n",(0,n.jsx)(i.p,{children:"For a monocular camera: Tx = Ty = 0, and typically R is the identity matrix with P[1:3,1:3] = K."}),"\n",(0,n.jsx)(i.p,{children:"For a stereo pair, the fourth column [Tx Ty 0]' relates to the position of the optical center of the second camera in the coordinate system of the first camera. We assume Tz = 0 so that the two cameras are in the same stereo image plane. Tx is always 0 and Ty = 0 for the first camera. For the right (second) camera of a horizontal stereo pair, Ty = 0 and Tx = -fx' * B, where B is the baseline between the cameras."}),"\n",(0,n.jsx)(i.p,{children:"Given a 3D point [X Y Z]', the projection (x, y) of the point on the rectified image is calculated as:"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"[u v w]' = P * [X Y Z 1]'\nx = u / w\ny = v / w\n"})}),"\n",(0,n.jsx)(i.p,{children:"This applies to both images of a stereo pair."}),"\n",(0,n.jsx)(i.h2,{id:"references",children:"References"}),"\n",(0,n.jsx)(i.p,{children:"coScene's schema types are framework-independent and can be implemented using any supported message encoding format."}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Encoding Format"}),(0,n.jsx)(i.th,{children:"Schema Name"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"ROS 1"}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://github.com/foxglove/foxglove-sdk/blob/main/schemas/ros1/CameraCalibration.msg",children:(0,n.jsx)(i.code,{children:"foxglove_msgs/CameraCalibration"})})})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"ROS 2"}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://github.com/foxglove/foxglove-sdk/blob/main/schemas/ros2/CameraCalibration.msg",children:(0,n.jsx)(i.code,{children:"foxglove_msgs/msg/CameraCalibration"})})})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"JSON"}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://github.com/foxglove/foxglove-sdk/blob/main/schemas/jsonschema/CameraCalibration.json",children:(0,n.jsx)(i.code,{children:"foxglove.CameraCalibration"})})})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"Protobuf"}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://github.com/foxglove/foxglove-sdk/blob/main/schemas/proto/foxglove/CameraCalibration.proto",children:(0,n.jsx)(i.code,{children:"foxglove.CameraCalibration"})})})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"FlatBuffers"}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://github.com/foxglove/foxglove-sdk/blob/main/schemas/flatbuffer/CameraCalibration.fbs",children:(0,n.jsx)(i.code,{children:"foxglove.CameraCalibration"})})})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"OMG IDL"}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://github.com/foxglove/foxglove-sdk/blob/main/schemas/omgidl/foxglove/CameraCalibration.idl",children:(0,n.jsx)(i.code,{children:"foxglove::CameraCalibration"})})})]})]})]}),"\n",(0,n.jsxs)(i.blockquote,{children:["\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.strong,{children:"Note"}),": You must use the schema names specified above for coScene to recognize them correctly."]}),"\n"]})]})}function h(e={}){let{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},68502:function(e,i,t){t.d(i,{Z:()=>o,a:()=>a});var r=t(41699);let n={},s=r.createContext(n);function a(e){let i=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),r.createElement(s.Provider,{value:i},e.children)}}}]);