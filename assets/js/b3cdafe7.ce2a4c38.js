"use strict";(self.webpackChunk_coscene_io_docs=self.webpackChunk_coscene_io_docs||[]).push([["3259"],{81066:function(e,o,r){r.r(o),r.d(o,{metadata:()=>n,default:()=>h,frontMatter:()=>c,contentTitle:()=>a,toc:()=>s,assets:()=>i});var n=JSON.parse('{"id":"developers/cocli/cli-common-batch-tasks","title":"Examples of Common Batch Operations","description":"The batch operation examples in this document use the jq tool to parse JSON output, which is more reliable and stable than parsing table output.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/developers/cocli/97-cli-common-batch-tasks.md","sourceDirName":"developers/cocli","slug":"/developers/cocli/common-batch-tasks","permalink":"/docs/developers/cocli/common-batch-tasks","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"angryPopcorn","lastUpdatedAt":1768299104000,"sidebarPosition":4,"frontMatter":{"slug":"common-batch-tasks","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Managing Actions with CLI Tools","permalink":"/docs/developers/cocli/action-operations"},"next":{"title":"Auto-completion","permalink":"/docs/developers/cocli/auto-complete"}}'),t=r(25105),l=r(81659);let c={slug:"common-batch-tasks",sidebar_position:4},a="Examples of Common Batch Operations",i={},s=[{value:"Upload the Same File to All Records in a Project",id:"upload-the-same-file-to-all-records-in-a-project",level:2},{value:"Create a Record for Each Folder in the Current Directory and Upload Files",id:"create-a-record-for-each-folder-in-the-current-directory-and-upload-files",level:2},{value:"Iterate Through All Records and Perform Operations",id:"iterate-through-all-records-and-perform-operations",level:2},{value:"Find All Empty Records Without Any Files",id:"find-all-empty-records-without-any-files",level:3},{value:"Tag All Empty Records",id:"tag-all-empty-records",level:3},{value:"Batch Download All Records with a Specific Label",id:"batch-download-all-records-with-a-specific-label",level:3},{value:"Delete All Empty Records",id:"delete-all-empty-records",level:3}];function d(e){let o={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"examples-of-common-batch-operations",children:"Examples of Common Batch Operations"})}),"\n",(0,t.jsxs)(o.admonition,{title:"Recommend Using JSON Output",type:"tip",children:[(0,t.jsxs)(o.p,{children:["The batch operation examples in this document use the ",(0,t.jsx)(o.code,{children:"jq"})," tool to parse JSON output, which is more reliable and stable than parsing table output.\nIf your system doesn't have ",(0,t.jsx)(o.code,{children:"jq"})," installed, you can install it with the following commands:"]}),(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:["macOS: ",(0,t.jsx)(o.code,{children:"brew install jq"})]}),"\n",(0,t.jsxs)(o.li,{children:["Ubuntu/Debian: ",(0,t.jsx)(o.code,{children:"sudo apt-get install jq"})]}),"\n",(0,t.jsxs)(o.li,{children:["CentOS/RHEL: ",(0,t.jsx)(o.code,{children:"sudo yum install jq"})]}),"\n"]})]}),"\n",(0,t.jsx)(o.h2,{id:"upload-the-same-file-to-all-records-in-a-project",children:"Upload the Same File to All Records in a Project"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-bash",children:"# Use JSON output and jq to extract record names\ncocli record list -o json | jq -r '.records[].name' | \\\n  xargs -I {} cocli record upload {} ./FILE_FLAG\n"})}),"\n",(0,t.jsx)(o.h2,{id:"create-a-record-for-each-folder-in-the-current-directory-and-upload-files",children:"Create a Record for Each Folder in the Current Directory and Upload Files"}),"\n",(0,t.jsx)(o.p,{children:"Assume we have the following 5 folders, each containing several random files and folders, as shown in the structure below."}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"list-folders-tree-view",src:r(98359).A+"",width:"1440",height:"1424"})}),"\n",(0,t.jsx)(o.p,{children:"We can use the coScene CLI tool and standard Linux command line tools to create records and upload files all at once."}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-bash",children:'# Iterate through all subdirectories in the current directory\nfor dir in */; do\n  # Remove the trailing slash from the directory name and create a new record, getting the full resource name\n  record_name=$(cocli record create -t "${dir%/}" -o json | jq -r \'.name\')\n\n  # Upload the contents of the current subdirectory to the created record\n  cocli record upload -R "$record_name" "$dir"\ndone\n'})}),"\n",(0,t.jsx)(o.p,{children:"Open any record on the web interface to see that the command line has uploaded all files and folders from the local directory to the corresponding record."}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.img,{alt:"cocli-multiple-folders-uploaded",src:r(75090).A+"",width:"2514",height:"1108"})}),"\n",(0,t.jsx)(o.h2,{id:"iterate-through-all-records-and-perform-operations",children:"Iterate Through All Records and Perform Operations"}),"\n",(0,t.jsx)(o.p,{children:"A common command line operation pattern is to iterate through all records in a user-specified project and perform operations based on a specific pattern."}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-bash",children:"# Use JSON output to get all records in the project, iterate and provide the full resource name\ncocli record list -o json | jq -r '.records[].name' | while read -r record_name; do\n    # Use $record_name for subsequent batch operations\n    # To extract record ID, you can use: record_id=$(basename \"$record_name\")\ndone\n"})}),"\n",(0,t.jsx)(o.p,{children:"This pattern can be extended to connect more complex batch operations."}),"\n",(0,t.jsx)(o.h3,{id:"find-all-empty-records-without-any-files",children:"Find All Empty Records Without Any Files"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-bash",children:'cocli record list -o json | jq -r \'.records[].name\' | while read -r record_name; do\n    # Get the number of files in the record\n    file_count=$(cocli record file list "$record_name" -o json 2>/dev/null | jq \'.files | length\')\n\n    # Check if the file list is empty\n    if [[ "$file_count" -eq 0 ]]; then\n        # Extract record ID and output\n        record_id=$(basename "$record_name")\n        echo "Record $record_id has no files."\n    fi\ndone\n'})}),"\n",(0,t.jsx)(o.h3,{id:"tag-all-empty-records",children:"Tag All Empty Records"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-bash",children:'cocli record list -o json | jq -r \'.records[].name\' | while read -r record_name; do\n    # Get the number of files in the record\n    file_count=$(cocli record file list "$record_name" -o json 2>/dev/null | jq \'.files | length\')\n\n    # Check if the file list is empty\n    if [[ "$file_count" -eq 0 ]]; then\n        # Tag all empty records with empty-record\n        cocli record update "$record_name" --append-labels empty-record\n    fi\ndone\n'})}),"\n",(0,t.jsx)(o.h3,{id:"batch-download-all-records-with-a-specific-label",children:"Batch Download All Records with a Specific Label"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-bash",children:"# Use --labels parameter to filter records with specific labels\ncocli record list --labels test-label -o json | jq -r '.records[].name' | while read -r record_name; do\n    # Download all records with test-label\n    cocli record download \"$record_name\" download-folder\ndone\n"})}),"\n",(0,t.jsx)(o.h3,{id:"delete-all-empty-records",children:"Delete All Empty Records"}),"\n",(0,t.jsx)(o.admonition,{type:"danger",children:(0,t.jsxs)(o.p,{children:["Please be very careful with the ",(0,t.jsx)(o.code,{children:"delete"})," operation, as it may delete important data!!"]})}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-bash",children:'cocli record list -o json | jq -r \'.records[].name\' | while read -r record_name; do\n    # Get the number of files in the record\n    file_count=$(cocli record file list "$record_name" -o json 2>/dev/null | jq \'.files | length\')\n\n    # Check if the file list is empty\n    if [[ "$file_count" -eq 0 ]]; then\n        # Delete the current record, using the -f flag to skip manual confirmation\n        cocli record delete "$record_name" -f\n    fi\ndone\n'})})]})}function h(e={}){let{wrapper:o}={...(0,l.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},75090:function(e,o,r){r.d(o,{A:()=>n});let n=r.p+"assets/images/cocli-multiple-folders-uploaded-e063c73b4738f74a8045c92b696e270b.png"},98359:function(e,o,r){r.d(o,{A:()=>n});let n=r.p+"assets/images/list-folders-tree-view-f1342ff6ea616cb305c1302373ae791f.png"},81659:function(e,o,r){r.d(o,{R:()=>c,x:()=>a});var n=r(58101);let t={},l=n.createContext(t);function c(e){let o=n.useContext(l);return n.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),n.createElement(l.Provider,{value:o},e.children)}}}]);