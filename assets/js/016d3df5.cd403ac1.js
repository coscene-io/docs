"use strict";(self.webpackChunk_coscene_io_docs=self.webpackChunk_coscene_io_docs||[]).push([["9579"],{37661:function(e,n,i){i.r(n),i.d(n,{metadata:()=>s,default:()=>h,frontMatter:()=>l,contentTitle:()=>c,toc:()=>a,assets:()=>r});var s=JSON.parse('{"id":"use-case/data-diagnosis/get-started","title":"Set Up Your Data Collection","description":"Use the following scenario as an example to quickly get started with the automatic data collection workflow:","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/use-case/data-diagnosis/2-get-started.md","sourceDirName":"use-case/data-diagnosis","slug":"/use-case/data-diagnosis/get-started","permalink":"/docs/use-case/data-diagnosis/get-started","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"Yujing Zheng","lastUpdatedAt":1762326384000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"About Automatic Data Collection and Diagnosis","permalink":"/docs/use-case/data-diagnosis/intro"},"next":{"title":"Add Rule","permalink":"/docs/use-case/data-diagnosis/add-rule"}}'),t=i(25105),d=i(81659);let l={sidebar_position:2},c="Set Up Your Data Collection",r={},a=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Device Configuration",id:"device-configuration",level:2},{value:"Create Rule",id:"create-rule",level:2},{value:"Add Device to Project",id:"add-device-to-project",level:2},{value:"Write File on the Device",id:"write-file-on-the-device",level:2},{value:"View Created Records",id:"view-created-records",level:2},{value:"Learn More",id:"learn-more",level:2}];function o(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"set-up-your-data-collection",children:"Set Up Your Data Collection"})}),"\n",(0,t.jsx)(n.p,{children:"Use the following scenario as an example to quickly get started with the automatic data collection workflow:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["When a newly generated ",(0,t.jsx)(n.code,{children:".mcap"})," file on the device contains the topic ",(0,t.jsx)(n.code,{children:"/error_status"}),", and the ",(0,t.jsx)(n.code,{children:"data"})," field of that topic includes event codes ",(0,t.jsx)(n.code,{children:"1001 ~ 1005"}),", data from 5 minutes before to 1 minute after the timestamp will be automatically collected and saved to a record. Example message:"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"errortopic",src:i(25690).A+"",width:"697",height:"91"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Prepare a Linux device."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Create a project named ",(0,t.jsx)(n.code,{children:"auto-upload"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Make sure your role is \u201COrganization Admin\u201D. If not, contact your organization admin to update your role."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"org-role",src:i(23082).A+"",width:"1515",height:"378"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"device-configuration",children:"Device Configuration"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Go to the Organization Management > Devices > Device Configuration page and configure global rule-based data collection settings."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"device-config_1",src:i(92472).A+"",width:"1596",height:"399"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Assuming the bag file directory on the device is ",(0,t.jsx)(n.code,{children:"/home/bag"})," and the topic to monitor is ",(0,t.jsx)(n.code,{children:"/error_status"}),", configure it as follows:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"mod:\n# mod name, default is 'default'\nname: 'default'\nconf:\n   # Enable status, default is true\n   enabled: true\n\n   # (For rule-based collection) Directory to listen to on the device\n   listen_dirs: \n      - /home/bag/\n\n   # (For manual and rule-based collection) Directory to collect from\n   collect_dirs: \n      - /home/bag/\n      \n# (For rule-based collection) Topics available for trigger matching\ntopics:\n- /error_status\n"})}),"\n",(0,t.jsxs)(n.p,{children:["For more configuration options, see ",(0,t.jsx)(n.a,{href:"/docs/device/device-collector",children:"Device Configuration Format"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"create-rule",children:"Create Rule"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Enter the auto-upload project"}),"\n",(0,t.jsx)("img",{src:i(57842).A,alt:"pro-1",width:"500"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Go to Devices > Rules & matching page and create a rule from a template."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"add-rule-demo_1",src:i(63809).A+"",width:"1469",height:"430"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Choose the error code collection rule and download the sample .mcap file."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"add-rule-demo_2",src:i(14826).A+"",width:"1470",height:"488"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"View and save the rule:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"add-rule_2",src:i(51670).A+"",width:"1214",height:"863"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Event detection"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Topic to monitor: /error_status"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Error code list: Upload a CSV/JSON file formatted with a code column, like:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"errorcode-list",src:i(35719).A+"",width:"1370",height:"348"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Trigger condition: mag.data contains any value from the code column"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This means: monitor topic /error_status, and check whether the data field contains keywords 1001 ~ 1005"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Data collection"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Time Range:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Collect files from ",(0,t.jsx)(n.code,{children:"collect_dirs"})," 5 minutes before and 1 minute after the trigger timestamp"]}),"\n",(0,t.jsx)(n.li,{children:"Time is determined based on file content"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Record: Used to identify where the data from each collection will be saved.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Example: ",(0,t.jsx)(n.code,{children:"code: {scope.code}-name: {scope.name}"}),". If event code ",(0,t.jsx)(n.code,{children:"1002"})," is triggered, the record will be named: ",(0,t.jsx)(n.code,{children:"code:1002-name:	Target unreachable! Please assist"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key moment identification"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'After data is uploaded to the record, a "Moment" will be created at the trigger time for later analysis.'}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Enable the rule\nOnly after enabling the rule will devices in the project begin monitoring based on the rule."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"rule-enable",src:i(24839).A+"",width:"1470",height:"422"})}),"\n",(0,t.jsxs)(n.p,{children:["*See more rule condition examples in ",(0,t.jsx)(n.a,{href:"/docs/use-case/data-diagnosis/add-rule",children:"Rules"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"add-device-to-project",children:"Add Device to Project"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Create the monitoring and collection directory ",(0,t.jsx)(n.code,{children:"/home/bag"})," on the device:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"cd /home\nmkdir bag\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Go to Project > Devices page to get the device installation command."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"pro-add-device_1",src:i(40015).A+"",width:"1527",height:"425"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Run the installation command on the device:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"pro-add-device_2",src:i(49172).A+"",width:"1470",height:"982"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"After installation, the device will be automatically added to the project. Go to Organization Management > Devices to enable the device, and it will start collecting data automatically based on the rule."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"enable-device",src:i(68593).A+"",width:"1513",height:"425"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"write-file-on-the-device",children:"Write File on the Device"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Confirm the device has received the rule"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"View logs on the device using the following command:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"tail -f ~/.local/state/cos/logs/cos.log\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["If you see ",(0,t.jsx)(n.code,{children:"received rules"})," in the logs, the rule was received successfully."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"rule-log-1",src:i(67264).A+"",width:"1079",height:"179"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Copy the .mcap file from step 3 of Create Rule to the device directory ",(0,t.jsx)(n.code,{children:"/home/bag/"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Automatic .mcap upload:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"If the logs show the following, it means a rule was triggered:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"rule-log-2",src:i(22299).A+"",width:"1313",height:"267"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"If the logs show uploaded, the .mcap file was successfully uploaded."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"rule-log-3",src:i(56946).A+"",width:"1313",height:"423"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"view-created-records",children:"View Created Records"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Enter the project and view the automatically created records:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"collect-record",src:i(28501).A+"",width:"1470",height:"351"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"View the data uploaded to the record:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"auto-record-2",src:i(14617).A+"",width:"1470",height:"588"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"View the Moment created at the trigger time:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"auto-record-3",src:i(98864).A+"",width:"1470",height:"585"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"learn-more",children:"Learn More"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/use-case/data-diagnosis/add-rule",children:"Add a Rule"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/viz/about-viz",children:"Visualize and Replay Data"})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},57842:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/pro-1-820868057b6af0c2d34020fde3370c3a.png"},63809:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/add-rule-demo_1-9ae793ca7e7ecd6aede08d3c28698cdb.png"},14826:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/add-rule-demo_2-c3f8d8487cf46387da3e86b98968644b.png"},51670:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/add-rule_2-601313c05b064733a15089bb96f97274.png"},14617:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/auto-record-2-d67d70d57daeb309240169aa7a40429d.png"},98864:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/auto-record-3-7f04b27ee9f30b84816ee17df9e53f71.png"},28501:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/collect-record-2f948997ba04847af919f32997a91b8b.png"},92472:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/device-config_1-508838c3b5f3aebfd25b7bca8e572b00.png"},68593:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/enable-device-17c92a8c57ad76ceba403b3ae5d51cfc.png"},35719:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/errorcode-list-fb75c0840153d17d182fb47adaac6dad.png"},25690:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/errortopic-756ab1beb4bedfc6aa3ebad249972e13.png"},23082:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/org-role-d6fd32f245825221f41bea6555009127.png"},40015:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/pro-add-device_1-5498af2596316dce63b201ff07f93fc5.png"},49172:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/pro-add-device_2-de1fb76bcd82f631e7b919f4830e32ca.png"},24839:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/rule-enable-fdda028c27e5a3a0818a3dd9dd2c2cec.png"},67264:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/rule-log-1-c55396a2cff89a5928d07add55d0303f.png"},22299:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/rule-log-2-37ed95c7947b7eb2cfdd0253a588ac2d.png"},56946:function(e,n,i){i.d(n,{A:()=>s});let s=i.p+"assets/images/rule-log-3-3e8b99b16cd533810d81cb66eecb4311.png"},81659:function(e,n,i){i.d(n,{R:()=>l,x:()=>c});var s=i(58101);let t={},d=s.createContext(t);function l(e){let n=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);